# ðŸš€ Next Steps - Story 2.1 Validation

## âš¡ Quick Start Commands

### 1. Generate Mocks for Tests
```bash
cd /Users/mathis/Desktop/Projets/PFT
dart run build_runner build --delete-conflicting-outputs
```

### 2. Run Unit Tests
```bash
flutter test
```

### 3. Run Analyzer
```bash
flutter analyze
```

### 4. Run App on Device/Simulator
```bash
# iOS Simulator
flutter run

# Android Emulator
flutter run

# Specific device
flutter devices
flutter run -d <device-id>
```

### 5. Check Coverage
```bash
flutter test --coverage
genhtml coverage/lcov.info -o coverage/html
open coverage/html/index.html
```

---

## âœ… Validation Checklist

### Compilation & Tests
- [ ] Code compiles without errors
- [ ] All unit tests pass
- [ ] Test coverage > 80%
- [ ] No analyzer warnings

### Functional Testing (on Device)
- [ ] App launches successfully
- [ ] First launch seeds 51 exercises
- [ ] Exercise list displays correctly
- [ ] Exercises grouped by muscle group (6 groups)
- [ ] Exercise cards show:
  - [ ] Exercise name
  - [ ] Equipment icon (color-coded)
  - [ ] Muscle group badge
  - [ ] Category badge (Compound/Isolation)
- [ ] Loading state shows CircularProgressIndicator
- [ ] Second launch doesn't re-seed (already seeded check)
- [ ] Error handling works (disconnect internet, check retry)

### Performance Testing
- [ ] First launch seed time < 100ms
- [ ] Exercise list renders smoothly (60 FPS)
- [ ] Scroll performance is smooth with 51 items
- [ ] Memory usage is reasonable

### Database Verification
- [ ] Database file created at correct path
- [ ] 51 exercises in database
- [ ] Indexes created (muscle_group, is_custom)
- [ ] No duplicate exercises

---

## ðŸ› Known Issues to Watch For

1. **iOS Asset Loading:** Verify `assets/data/exercises.json` loads correctly
2. **Database Path:** Check sqflite database path on both platforms
3. **Enum Parsing:** Ensure all 51 exercises parse without errors
4. **Memory:** Monitor memory with Flutter DevTools

---

## ðŸ“Š Expected Results

### Exercise Count by Muscle Group
- Chest: 8 exercises
- Back: 9 exercises
- Shoulders: 7 exercises
- Arms: 6 exercises
- Legs: 10 exercises
- Core: 6 exercises
- **Total: 51 exercises**

### First Launch Flow
```
1. App starts â†’ MyApp builds
2. ExerciseBloc created â†’ SeedExercisesIfNeeded dispatched
3. ExerciseLoading state â†’ CircularProgressIndicator shows
4. SeedService checks hasExercises() â†’ false
5. Load exercises.json from assets
6. Parse 51 exercises
7. Bulk insert to SQLite (transaction)
8. ExercisesLoaded state â†’ List displays
9. Grouped by muscle group, alphabetically sorted
```

### Subsequent Launches
```
1. App starts â†’ ExerciseBloc created
2. SeedExercisesIfNeeded dispatched
3. ExerciseLoading state
4. SeedService checks hasExercises() â†’ true
5. Skip seeding
6. Load from database
7. ExercisesLoaded state â†’ List displays
```

---

## ðŸ”§ Troubleshooting

### Problem: Tests don't run
**Solution:** 
```bash
flutter pub get
dart run build_runner build --delete-conflicting-outputs
flutter test
```

### Problem: App crashes on launch
**Check:**
1. pubspec.yaml has correct dependencies
2. assets/data/exercises.json exists
3. Flutter version compatibility

### Problem: Database not created
**Check:**
1. sqflite permissions (iOS: Info.plist, Android: manifest)
2. Database path using `getDatabasesPath()`
3. Check device logs with `flutter logs`

### Problem: Exercises don't display
**Check:**
1. BLoC state transitions with debugPrint
2. Database query returns results
3. JSON parsing succeeds (no exceptions)

---

## ðŸ“± Testing on Multiple Platforms

### iOS Testing
```bash
# List iOS simulators
xcrun simctl list devices

# Open simulator
open -a Simulator

# Run on simulator
flutter run
```

### Android Testing
```bash
# List Android emulators
flutter emulators

# Launch emulator
flutter emulators --launch <emulator-id>

# Run on emulator
flutter run
```

---

## ðŸŽ¯ Performance Profiling

### Using Flutter DevTools
```bash
# Open DevTools
flutter pub global activate devtools
flutter pub global run devtools

# Run app in profile mode
flutter run --profile

# Navigate to Performance tab
# Record timeline during:
# 1. First launch (seeding)
# 2. List scrolling
# 3. App restart (no seeding)
```

### Target Metrics
- Seed time: < 100ms
- UI frames: 60 FPS (16.67ms per frame)
- Memory: < 50MB for this feature alone
- Database query: < 50ms

---

## âœ… Definition of Done

Before marking Story 2.1 as "Ready for Review":

- [ ] All tests pass (unit + widget + integration)
- [ ] Test coverage > 80%
- [ ] No compilation errors
- [ ] No analyzer warnings
- [ ] Functional testing complete on iOS & Android
- [ ] Performance KPIs validated (< 100ms seed)
- [ ] Code review completed
- [ ] Documentation updated
- [ ] IMPLEMENTATION-SUMMARY.md reviewed

---

## ðŸ“ž Need Help?

**Common Questions:**

**Q: How do I check test coverage?**
A: Run `flutter test --coverage` then open `coverage/lcov.info`

**Q: Where's the database file?**
A: iOS: `~/Library/Developer/CoreSimulator/Devices/<ID>/data/Containers/Data/Application/<ID>/Documents/pft.db`
   Android: `/data/data/com.example.pft/databases/pft.db`

**Q: How to reset the database?**
A: Uninstall app and reinstall, or use `flutter clean` then rebuild

**Q: Tests fail with "No mock found"?**
A: Run `dart run build_runner build` to generate mocks

---

*Validation Guide for Story 2.1 - Exercise Database*  
*Developer: Test all items before marking "Ready for Review"*  
*Estimated validation time: 30-45 minutes*

