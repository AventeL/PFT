# Story 6.3: Historique par exercice

## Status
**Draft**

---

## Story

**As a** utilisateur,  
**I want to** voir l'historique complet d'un exercice spécifique,  
**so that** je visualise ma progression sur cet exercice.

---

## Acceptance Criteria

1. Screen "Exercise History" accessible depuis exercice
2. Liste chronologique de toutes sessions incluant cet exercice
3. Affichage: date, sets×reps@weight
4. Exemple: "2026-01-05: 3×8@80kg, 3×6@85kg"
5. Pagination ou infinite scroll si > 50 sessions
6. Performance: chargement < 300ms pour 2 ans données
7. Link vers session details (tap)

---

## Tasks / Subtasks

### Use Cases
- [ ] **Task 1: Create Exercise History Use Case** (AC: 2-4, 6)
  - [ ] Subtask 1.1: Create `GetExerciseHistory` use case
    - Input: exerciseId, limit, offset
    - Query all sessions with this exercise
    - Return sessions with performed sets
  - [ ] Subtask 1.2: Optimize query with indexes

### State Management
- [ ] **Task 2: Extend HistoryBloc** (AC: 1, 5)
  - [ ] Subtask 2.1: Add LoadExerciseHistory event
  - [ ] Subtask 2.2: Handle pagination

### UI Layer
- [ ] **Task 3: Create Exercise History Screen** (AC: 1-5, 7)
  - [ ] Subtask 3.1: Create ExerciseHistoryScreen
    - Exercise name in AppBar
    - List of sessions
  - [ ] Subtask 3.2: Create ExerciseHistoryItem widget
    - Date
    - Sets summary: "3×8@80kg, 2×6@85kg"
    - Tap → SessionDetailsScreen
  - [ ] Subtask 3.3: Implement pagination/infinite scroll

### Testing
- [ ] **Task 4: Tests**
  - [ ] Subtask 4.1: Test query performance
  - [ ] Subtask 4.2: Test pagination

---

## Dev Notes

### Query
**Source:** [PRD Feature 5 - US-5.1]

```sql
SELECT 
  s.id, s.start_time,
  sr.reps, sr.weight, sr.set_number
FROM workout_sessions s
JOIN performed_exercises pe ON pe.session_id = s.id
JOIN set_records sr ON sr.performed_exercise_id = pe.id
WHERE pe.exercise_id = ?
  AND s.status = 'completed'
ORDER BY s.start_time DESC
LIMIT ? OFFSET ?;
```

### Display Format
"Jan 5, 2026: 3×8@80kg, 2×6@85kg"

### Performance
Index on performed_exercises.exercise_id

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-11 | 1.0 | Initial story creation | Mathis (PM) |

---

## Dev Agent Record
_To be filled by dev agent_

---

## QA Results
_To be filled by QA agent_

